<div id="map_canvas"></div>
<div data-role="tabs" id="tabs">
  <div data-role="navbar">
    <ul>
      <li><a id="marker" href="#one" data-ajax="false">Marker</a></li>
      <li><a id="polyline" href="#two" data-ajax="false">Polyline</a></li>
      <li><a id="polygon" href="#three" data-ajax="false">Polygon</a></li>
    </ul>
  </div>
</div>
<script type="text/javascript">

$(document).one("pageLoad", function(event, map) {
  $("#polyline").click(function() {
    loadKml(map, "www/kml/polyline.kml");
  });
  $("#marker").click(function() {
    loadKml(map, "www/kml/marker.kml");
  });
  $("#polygon").click(function() {
    loadKml(map, "www/kml/polygon.kml");
  });
  $("#marker").click();
});

function loadKml(map, url) {
  map.clear();
  map.setZoom(0);

  //Load the kml file
  map.addKmlOverlay({
    url: url,
    preserveViewport: false,
    animation: true
  }, function(kmlLayer) {
    kmlLayer.on(plugin.google.maps.event.OVERLAY_CLICK, function(overlay, latLng) {
      switch (overlay.type) {
        case "Marker":
          overlay.setSnippet("Marker clicked!");
          overlay.showInfoWindow();
          break;
        case "Polygon":
          overlay.setFillColor("red");
          break;
        case "Polyline":
          var width = overlay.getWidth();
          overlay.setWidth(10);
          setTimeout(function() {
            overlay.setWidth(width);
          }, 3000);
          break;
      }
      
    });
  });
}
</script>
